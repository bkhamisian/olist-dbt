version: 2

semantic_models:
  - name: customers_semantic_model
    model: ref('dim_customers')
    description: "Semantic model for customer data, including order statistics."
    defaults:
      agg_time_dimension: first_order_date
    entities:
      - name: customer
        expr: customer_unique_id
        type: primary
        description: "Unique identifier for each customer."
    measures:
      - name: total_orders
        description: "Total number of orders placed by the customer."
        expr: "total_orders"
        agg: sum
      - name: total_spent
        description: "Total amount spent by the customer."
        expr: "total_spent"
        agg: sum
    dimensions:
      - name: first_order_date
        expr: date_trunc('day', first_order_date)
        description: "Date of the customer's first order."
        type: time
        type_params:
          time_granularity: day
#      - name: is_large_order
#        type: categorical
#        expr: case when order_total > 50 then true else false end
#      - name: avg_delivery_time
#        description: "Average delivery time for the customer's orders."
#        type: number

metrics:
  - name: customer_orders
    description: "Unique count of customers placing orders"
    label: "Customers with Orders"
    type: simple
    type_params:
      measure: total_orders
